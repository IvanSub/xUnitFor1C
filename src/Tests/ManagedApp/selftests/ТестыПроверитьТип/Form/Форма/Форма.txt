&НаКлиенте
Перем Я_Тест;

&НаКлиенте
Функция ПолучитьСписокТестов(юТест) Экспорт
	
	Я_Тест = юТест;
	
	Результат = Я_Тест.Новый_НаборТестов();
	
	Я_Тест.НаборТестов_Добавить(Результат, "Тест_ПроверитьТип_НаименованиеТипа");
	Я_Тест.НаборТестов_Добавить(Результат, "Тест_ПроверитьТип_СамТип");
	Я_Тест.НаборТестов_Добавить(Результат, "Тест_ПроверитьТип_Ошибки");
	
	Возврат Результат;
	
КонецФункции

&НаКлиенте
Процедура Тест_ПроверитьТип_НаименованиеТипа() Экспорт
	
	Я_Тест.ПроверитьТип(ТипЗнч(1), "Тип");
	
	Я_Тест.ПроверитьТип(1, "Число");
	Я_Тест.ПроверитьТип(0, "Число");
	
	Я_Тест.ПроверитьТип("", "Строка");
	Я_Тест.ПроверитьТип("12", "Строка");
	
	Я_Тест.ПроверитьТип(Ложь, "Булево");
	Я_Тест.ПроверитьТип(Истина, "Булево");
	
	Я_Тест.ПроверитьТип('00010101', "Дата");
	Я_Тест.ПроверитьТип(ТекущаяДата(), "Дата");
	
    //Если Метаданные.Справочники.Количество() > 0 Тогда
    //	имяМетаданного = Метаданные.Справочники[0].Имя;
    //	Я_Тест.ПроверитьТип(Справочники[имяМетаданного].ПустаяСсылка(), "СправочникСсылка."+имяМетаданного);
    //КонецЕсли; 
    //Если Метаданные.Документы.Количество() > 0 Тогда
    //	имяМетаданного = Метаданные.Документы[0].Имя;
    //	Я_Тест.ПроверитьТип(Документы[имяМетаданного].ПустаяСсылка(), "ДокументСсылка."+имяМетаданного);
    //КонецЕсли; 
    //Если Метаданные.Отчеты.Количество() > 0 Тогда
    //	имяМетаданного = Метаданные.Отчеты[0].Имя;
    //	Я_Тест.ПроверитьТип(Отчеты[имяМетаданного].Создать(), "ОтчетОбъект."+имяМетаданного);
    //КонецЕсли; 
    //Если Метаданные.Обработки.Количество() > 0 Тогда
    //	имяМетаданного = Метаданные.Обработки[0].Имя;
    //	Я_Тест.ПроверитьТип(Обработки[имяМетаданного].Создать(), "ОбработкаОбъект."+имяМетаданного);
    //КонецЕсли; 
КонецПроцедуры

&НаКлиенте
Процедура Тест_ПроверитьТип_СамТип() Экспорт
	Я_Тест.ПроверитьТип(1, Тип("Число"));
	Я_Тест.ПроверитьТип(0, Тип("Число"));
	
	Я_Тест.ПроверитьТип("", Тип("Строка"));
	Я_Тест.ПроверитьТип("12", Тип("Строка"));
	
	Я_Тест.ПроверитьТип(ЛОЖЬ, Тип("Булево"));
	Я_Тест.ПроверитьТип(Истина, Тип("Булево"));
	
	Я_Тест.ПроверитьТип('00010101', Тип("Дата"));
	Я_Тест.ПроверитьТип(ТекущаяДата(), Тип("Дата"));
	
    //Если Метаданные.Справочники.Количество() > 0 Тогда
    //	имяМетаданного = Метаданные.Справочники[0].Имя;
    //	Я_Тест.ПроверитьТип(Справочники[имяМетаданного].ПустаяСсылка(), Тип("СправочникСсылка."+имяМетаданного));
    //КонецЕсли; 
    //Если Метаданные.Документы.Количество() > 0 Тогда
    //	имяМетаданного = Метаданные.Документы[0].Имя;
    //	Я_Тест.ПроверитьТип(Документы[имяМетаданного].ПустаяСсылка(), Тип("ДокументСсылка."+имяМетаданного));
    //КонецЕсли; 
    //Если Метаданные.Отчеты.Количество() > 0 Тогда
    //	имяМетаданного = Метаданные.Отчеты[0].Имя;
    //	Я_Тест.ПроверитьТип(Отчеты[имяМетаданного].Создать(), Тип("ОтчетОбъект."+имяМетаданного));
    //КонецЕсли; 
    //Если Метаданные.Обработки.Количество() > 0 Тогда
    //	имяМетаданного = Метаданные.Обработки[0].Имя;
    //	Я_Тест.ПроверитьТип(Обработки[имяМетаданного].Создать(), Тип("ОбработкаОбъект."+имяМетаданного));
    //КонецЕсли; 
КонецПроцедуры

&НаКлиенте
Процедура Тест_ПроверитьТип_Ошибки() Экспорт
	//Я_Тест.ПроверитьТип(1, Истина);
	//Я_Тест.ПроверитьТип(1, "Строка");
	
	Я_Тест.ПроверитьНеВыполнилось("ПроверитьТип(1, Истина)", "ПроверитьТип: Тип значения параметра ТипИлиИмяТипа должен быть <Тип> или <Строка>, а получили <Булево>");
	Я_Тест.ПроверитьНеВыполнилось("ПроверитьТип(1, ""Строка"")", "Типом значения <1> является <Число>, а ожидался тип <Строка>.");
	Я_Тест.ПроверитьНеВыполнилось("ПроверитьТип(1, ТипЗнч(""Строка""))", "Типом значения <1> является <Число>, а ожидался тип <Строка>.");
КонецПроцедуры
